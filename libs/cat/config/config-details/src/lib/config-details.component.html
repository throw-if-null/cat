<div class="config-details-container" *subscribe="searchControl.value$; let searchText;">

    <ng-container *ngIf="entries$ | async as entries; else loadingConfig">

        <h1>Config Entries</h1>
        <div class="list-controls">
            <input [formControl]="searchControl" autofocus class="input" placeholder="Type to search...">
        </div>

        <table class="table">
            <thead>
            <tr>
                <th></th>
                <th style="width: 30%;">KEY</th>
                <th style="width: 30%;">VALUE</th>
                <th>Edit</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let entry of entries | catFilter: searchText :  ['key', 'value']">
                <td></td>
                <td class="editable">
                    <cat-editable (edit)="entryEdited($event, entry , 'key')">
                        <ng-template viewMode>
                            <div [classToApply]="'search-highlight'"
                                 [content]="entry.key"
                                 [searchedWord]="searchText"
                                 [setTitle]="true"
                                 catHighlight
                                 class="edit-value">
                                {{entry.key}}
                            </div>
                        </ng-template>
                        <ng-template editMode>
                            <input #editInput
                                   (change)="entry.key"
                                   [value]="entry.key"
                                   class="edit-input input small edgy"/>
                        </ng-template>
                    </cat-editable>
                </td>

                <td class="editable">
                    <cat-editable (edit)="entryEdited($event, entry, 'value')">
                        <ng-template viewMode>
                            <div [classToApply]="'search-highlight'"
                                 [content]="entry.value"
                                 [searchedWord]="searchText"
                                 [setTitle]="true"
                                 [valueType]="entry.value"
                                 catHighlight
                                 class="edit-value">{{entry.value}}</div>
                        </ng-template>
                        <ng-template editMode>
                            <input #editInput
                                   (change)="entry.value"
                                   [value]="entry.value"
                                   class="edit-input input small edgy"/>
                        </ng-template>
                    </cat-editable>
                </td>
                <td>
                    <button (click)="deleteEntry(entry.id)">Delete</button>
                </td>
            </tr>
            </tbody>
        </table>

        <div *ngIf="entries.length === 0" class="no-entries">
            <p class="description">
                Seems you do not have any entries yet...</p>
            <button (click)="addEmptyEntry()" class="button primary">
                Add Entry
            </button>
        </div>

    </ng-container>

    <ng-template #loadingConfig>
        <div class="loading-section centered">
            <h1>Reading through your configs...</h1>
            <cat-loader></cat-loader>
        </div>
    </ng-template>
</div>
